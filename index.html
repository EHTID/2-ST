<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Adventure Game</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #000;
        }
        canvas {
            border: 1px solid #fff;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let ship, meteors, zigzagObstacles, stars, score, gameOver, planets, lives;

        function init() {
            ship = {
                x: canvas.width / 2 - 25,
                y: canvas.height - 70,
                width: 50,
                height: 60,
                dx: 0
            };

            meteors = [];
            zigzagObstacles = [];
            planets = [];
            stars = createStars(100);
            score = 0;
            gameOver = false;
            lives = 3;
        }

        function createStars(count) {
            const stars = [];
            for (let i = 0; i < count; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    radius: Math.random() * 1.5,
                    opacity: Math.random()
                });
            }
            return stars;
        }

        function drawStars() {
            ctx.fillStyle = '#fff';
            stars.forEach(star => {
                ctx.globalAlpha = star.opacity;
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
        }

        function drawShip() {
            ctx.fillStyle = '#00f';
            ctx.beginPath();
            ctx.moveTo(ship.x, ship.y);
            ctx.lineTo(ship.x + ship.width / 2, ship.y - ship.height);
            ctx.lineTo(ship.x + ship.width, ship.y);
            ctx.closePath();
            ctx.fill();
        }

        function drawMeteors() {
            ctx.fillStyle = '#f00';
            meteors.forEach(meteor => {
                ctx.beginPath();
                ctx.arc(meteor.x, meteor.y, meteor.radius, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function drawZigzagObstacles() {
            ctx.fillStyle = '#0f0';
            zigzagObstacles.forEach(obs => {
                ctx.beginPath();
                ctx.rect(obs.x, obs.y, obs.width, obs.height);
                ctx.fill();
            });
        }

        function drawPlanets() {
            ctx.fillStyle = '#ff0';
            planets.forEach(planet => {
                ctx.beginPath();
                ctx.arc(planet.x, planet.y, planet.radius, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function drawScore() {
            ctx.fillStyle = '#fff';
            ctx.font = '20px Arial';
            ctx.fillText(`Score: ${score}`, 10, 30);
            ctx.fillText(`Lives: ${lives}`, 10, 50);
        }

        function updateShip() {
            ship.x += ship.dx;
            if (ship.x < 0) ship.x = 0;
            if (ship.x + ship.width > canvas.width) ship.x = canvas.width - ship.width;
        }

        function updateMeteors() {
            const speed = 4 + Math.floor(score / 50);
            for (let i = 0; i < meteors.length; i++) {
                meteors[i].y += speed;

                if (meteors[i].y > canvas.height) {
                    meteors.splice(i, 1);
                    score++;
                }

                if (
                    ship.x < meteors[i].x + meteors[i].radius &&
                    ship.x + ship.width > meteors[i].x - meteors[i].radius &&
                    ship.y < meteors[i].y + meteors[i].radius &&
                    ship.y + ship.height > meteors[i].y - meteors[i].radius
                ) {
                    lives--;
                    meteors.splice(i, 1);
                    if (lives === 0) gameOver = true;
                }
            }

            if (Math.random() < 0.02) {
                const size = Math.random() * 20 + 10;
                meteors.push({
                    x: Math.random() * canvas.width,
                    y: -20,
                    radius: size
                });
            }
        }

        function updateZigzagObstacles() {
            const speed = 3 + Math.floor(score / 50);
            for (let i = 0; i < zigzagObstacles.length; i++) {
                zigzagObstacles[i].y += speed;
                zigzagObstacles[i].x += zigzagObstacles[i].dx;

                if (zigzagObstacles[i].y > canvas.height || zigzagObstacles[i].x > canvas.width || zigzagObstacles[i].x < -zigzagObstacles[i].width) {
                    zigzagObstacles.splice(i, 1);
                    score++;
                }

                if (
                    ship.x < zigzagObstacles[i].x + zigzagObstacles[i].width &&
                    ship.x + ship.width > zigzagObstacles[i].x &&
                    ship.y < zigzagObstacles[i].y + zigzagObstacles[i].height &&
                    ship.y + ship.height > zigzagObstacles[i].y
                ) {
                    lives--;
                    zigzagObstacles.splice(i, 1);
                    if (lives === 0) gameOver = true;
                }
            }

            if (Math.random() < 0.01) {
                const direction = Math.random() < 0.5 ? -1 : 1;
                const size = Math.random() * 30 + 20;
                zigzagObstacles.push({
                    x: direction < 0 ? canvas.width : -size,
                    y: -20,
                    width: size,
                    height: size,
                    dx: 2 * direction
                });
            }
        }

        function updatePlanets() {
            const speed = 1 + Math.floor(score / 100);
            for (let i = 0; i < planets.length; i++) {
                planets[i].y += speed;

                if (planets[i].y > canvas.height) {
                    planets.splice(i, 1);
                }

                if (
                    ship.x < planets[i].x + planets[i].radius &&
                    ship.x + ship.width > planets[i].x - planets[i].radius &&
                    ship.y < planets[i].y + planets[i].radius &&
                    ship.y + ship.height > planets[i].y - planets[i].radius
                ) {
                    lives--;
                    planets.splice(i, 1);
                    if (lives === 0) gameOver = true;
                }
            }

            if (score % 100 === 0 && score !== 0) {
                planets.push({
                    x: Math.random() < 0.5 ? 0 : canvas.width,
                    y: -canvas.height / 4,
                    radius: canvas.height / 8
                });
            }
        }

        function clear() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function update() {
            if (gameOver) {
                ctx.fillStyle = '#fff';
                ctx.font = '50px Arial';
                ctx.fillText('Game Over', canvas.width / 2 - 150, canvas.height / 2);
                ctx.font = '20px Arial';
                ctx.fillText('Tap to Restart', canvas.width / 2 - 70, canvas.height / 2 + 30);
                canvas.addEventListener('click', restartGame);
                return;
            }

            clear();
            drawStars();
            drawShip();
            drawMeteors();
            drawZigzagObstacles();
            drawPlanets();
            drawScore();
            updateShip();
            updateMeteors();
            updateZigzagObstacles();
            updatePlanets();
            requestAnimationFrame(update);
        }

        function handleTouchStart(e) {
            const touchX = e.touches[0].clientX;
            if (touchX < ship.x) {
                ship.dx = -5;
            } else {
                ship.dx = 5;
            }
        }

        function handleTouchEnd() {
            ship.dx = 0;
        }

        function restartGame() {
            canvas.removeEventListener('click', restartGame);
            init();
            update();
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                ship.dx = -5;
            } else if (e.key === 'ArrowRight') {
                ship.dx = 5;
            }
        });

        document.addEventListener('keyup', () => {
            ship.dx = 0;
        });

        canvas.addEventListener('touchstart', handleTouchStart);
        canvas.addEventListener('touchend', handleTouchEnd);

        init();
        update();
    </script>
</body>
</html>
